#!/usr/bin/env node
const startTime = new Date();
require('colors');
const co = require('co');
const program = require('caporal');
const checkUpdate = require('../lib/check-update');
const prepare = require('../lib/prepare');
const globalConfig = require('../lib/global-config');

co(function *() {
  program.__start__ = startTime;
  yield prepare();
  if (globalConfig.entity.checkUpgrade && (globalConfig.entity.checkUpgrade + '').trim() === "true") {
    yield checkUpdate();
  }
  require('../lib/gpm');
}).catch(function (err) {
  console.error(err);
});
